<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Shop Cart</title>
    <link rel="shortcut icon" type="image/x-icon" href="assets/images/favicon.ico" />
    <!-- Plugin css -->
    <link rel="stylesheet" type="text/css" href="assets/css/font-awesome.min.css" media="all" />
    <link rel="stylesheet" type="text/css" href="assets/fonts/flaticon.css" media="all" />
    <link rel="stylesheet" type="text/css" href="assets/css/bootstrap.min.css" media="all" />
    <link rel="stylesheet" type="text/css" href="assets/css/animate.css" media="all" />
    <link rel="stylesheet" type="text/css" href="assets/css/swiper.min.css" media="all" />
    <link rel="stylesheet" type="text/css" href="assets/css/lightcase.css" media="all" />
    <link rel="stylesheet" type="text/css" href="assets/css/jquery.nstSlider.css" media="all" />
    <link rel="stylesheet" type="text/css" href="assets/css/flexslider.css" media="all" />

    <!-- own style css -->
    <link rel="stylesheet" type="text/css" href="assets/css/style.css" media="all" />
    <link rel="stylesheet" type="text/css" href="assets/css/rtl.css" media="all" />
    <link rel="stylesheet" type="text/css" href="assets/css/responsive.css" media="all" />

    <!-- font awesome-->
    <script src="https://kit.fontawesome.com/808142aef7.js" crossorigin="anonymous"></script>

    <script src="shop_cart.js" type="module"></script>
    <script src="https://js.stripe.com/v3/"></script>
</head>

<body>

    <script>
        fetch('header.html')
            .then(response => response.text())
            .then(data => {
                document.querySelector('body').insertAdjacentHTML('afterbegin', data);
                console.log("I'm ready!")
                const mobile_menu_btn = document.querySelector("#hamburger-menu");
                mobile_menu_btn.addEventListener("click", () => {
                    const menu = document.querySelector("#mobile-menu")
                    menu.classList.toggle("mobile-menu-hide")
                    menu.classList.toggle("mobile-menu-show")
                })

                const mobile_close_btn = document.querySelector("#close-btn");
                mobile_close_btn.addEventListener("click", () => {
                    const menu = document.querySelector("#mobile-menu")
                    menu.classList.toggle("mobile-menu-hide")
                    menu.classList.toggle("mobile-menu-show")
                })

                const shop_menu = document.querySelectorAll(".mobile-shop-menu");

                shop_menu.forEach(menu => {
                    menu.addEventListener("click", () => {
                        const shop_list = menu.nextElementSibling; // Get the next sibling <ul>
                        if (shop_list) {
                            shop_list.classList.toggle("mobile-shop-sublist-show");
                            shop_list.classList.toggle("mobile-shop-sublist-hide");
                        }
                    });
                });
            });

        fetch('footer.html')
            .then(response => response.text())
            .then(data => document.querySelector('body').insertAdjacentHTML('beforeend', data));
    </script>

    <script type="module">

        // Import the function from the module file
        import { populateDropdown } from './cart_manager.js'

        window.addEventListener("load", () => {
            // Call the imported function
            populateDropdown();
        });
    </script>

    <div class="box-layout">
        <div class="box-style">
            <div class="color-btn">
                <a href="#"><i class="fa fa-cog fa-spin" aria-hidden="true"></i></a>
            </div>
            <div class="box-style-inner">
                <h3>Box Layout</h3>
                <div class="box-element">
                    <div class="box-heading">
                        <h5>HTML Layout</h5>
                    </div>
                    <div class="box-content">
                        <ul class="box-customize">
                            <li><a class="boxed-btn" href="#">Boxed</a></li>
                            <li><a class="wide-btn" href="#">Wide</a></li>
                            <li><a class="rtl-btn" href="#">Rtl</a></li>
                            <li><a class="ltl-btn" href="#">Ltl</a></li>
                        </ul>
                    </div>
                </div>
                <div class="box-element">
                    <div class="box-heading">
                        <h5>Backgroud Images</h5>
                    </div>
                    <div class="box-content">
                        <ul class="box-bg-img">
                            <li>
                                <a class="bg-1" href="#"><img src="assets/images/box-style/01.jpg" alt=""></a>
                            </li>
                            <li>
                                <a class="bg-2" href="#"><img src="assets/images/box-style/02.jpg" alt=""></a>
                            </li>
                            <li>
                                <a class="bg-3" href="#"><img src="assets/images/box-style/03.jpg" alt=""></a>
                            </li>
                            <li>
                                <a class="bg-4" href="#"><img src="assets/images/box-style/04.jpg" alt=""></a>
                            </li>
                            <li>
                                <a class="bg-5" href="#"><img src="assets/images/box-style/05.jpg" alt=""></a>
                            </li>
                            <li>
                                <a class="bg-6" href="#"><img src="assets/images/box-style/06.jpg" alt=""></a>
                            </li>
                            <li>
                                <a class="bg-7" href="#"><img src="assets/images/box-style/07.jpg" alt=""></a>
                            </li>
                            <li>
                                <a class="bg-8" href="#"><img src="assets/images/box-style/08.jpg" alt=""></a>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="box-element">
                    <div class="box-heading">
                        <h5>Backgroud Pattern</h5>
                    </div>
                    <div class="box-content">
                        <ul class="box-pattern-img">
                            <li>
                                <a class="pt-1" href="#"><img
                                        src="https://www.codexcoder.com/images/auror/pt-image/01.png"" alt=""></a>
                        </li>
                        <li>
                            <a class=" pt-2" href="#"><img
                                        src="https://www.codexcoder.com/images/auror/pt-image/02.png"" alt=""></a>
                        </li>
                        <li>
                            <a class=" pt-3" href="#"><img
                                        src="https://www.codexcoder.com/images/auror/pt-image/03.png"" alt=""></a>
                        </li>
                        <li>
                            <a class=" pt-4" href="#"><img
                                        src="https://www.codexcoder.com/images/auror/pt-image/04.png"" alt=""></a>
                        </li>
                        <li>
                            <a class=" pt-5" href="#"><img
                                        src="https://www.codexcoder.com/images/auror/pt-image/05.png"" alt=""></a>
                        </li>
                        <li>
                            <a class=" pt-6" href="#"><img
                                        src="https://www.codexcoder.com/images/auror/pt-image/06.png"" alt=""></a>
                        </li>
                        <li>
                            <a class=" pt-7" href="#"><img
                                        src="https://www.codexcoder.com/images/auror/pt-image/07.png"" alt=""></a>
                        </li>
                        <li>
                            <a class=" pt-8" href="#"><img
                                        src="https://www.codexcoder.com/images/auror/pt-image/08.png"" alt=""></a>
                        </li>
                    </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Start Page Header Section -->
        <section class=" bg-page-header">
                                    <div class="page-header-overlay">
                                        <div class="container">
                                            <div class="row">
                                                <div class="page-header">
                                                    <div class="page-title">
                                                        <h2>product cart page</h2>
                                                    </div>
                                                    <!-- .page-title -->
                                                </div>
                                                <!-- .page-header -->
                                            </div>
                                            <!-- .row -->
                                        </div>
                                        <!-- .container -->
                                    </div>
                                    <!-- .page-header-overlay -->
                                    </section>
                                    <!-- Start Shop Cart Section -->


                                    <section class="bg-product-cart-option">
                                        <div class="container">
                                            <div class="row">
                                                <div class="product-cart-option">
                                                    <div class="table-box">
                                                        <table class="cart-products-table">
                                                            <thead>
                                                                <tr>
                                                                    <th class="cart-product">Product</th>
                                                                    <th class="cart-price">Price</th>
                                                                    <th class="cart-edit">Edit</th>
                                                                </tr>
                                                            </thead>

                                                            <tbody class="cart-products">

                                                            </tbody>
                                                        </table>
                                                    </div>
                                                    <!-- .table-box -->

                                                    <div class="cart-checked-box">
                                                        <div class="cart-coupon-code">
                                                            <input type="text" name="text" placeholder="Coupon Code...">
                                                            <input type="submit" name="submit" value="apply coupon">
                                                        </div>
                                                        <!-- .coupon-code -->
                                                        <div class="cart-update">
                                                            <button type="submit">update cart</button>
                                                            <a href="stripe-checkout.html">proceed checkout</a>
                                                            <!-- JUST TO TEST -->
                                                            <form action="/create-checkout-session" method="POST">
                                                                <button type="submit"
                                                                    id="checkout-button">Checkout</button>
                                                            </form>
                                                            <!-- END TEST -->
                                                        </div>
                                                        <!-- .coupon-code -->
                                                    </div>
                                                    <!-- .cart-checked-box -->

                                                    <div class="chipping-box">
                                                        <div class="row g-4">
                                                            <div class="col-lg-6 col-12">
                                                                <h4>Calculate Shipping</h4>
                                                                <form action="#" method="POST" class="shipping-form">
                                                                    <div class="country-select">
                                                                        <select name="countries" id="countries">
                                                                        </select>
                                                                        <span class="select-icon"><i
                                                                                class="fa fa-angle-down"
                                                                                aria-hidden="true"></i></span>
                                                                    </div>
                                                                    <!-- .country-select -->
                                                                    <div class="row">
                                                                        <div class="col-md-6">
                                                                            <div class="form-group">
                                                                                <label class="sr-only"
                                                                                    for="country">State/Province
                                                                                    Province</label>
                                                                                <select name="states" id="states">
                                                                                </select>
                                                                                <span class="select-icon"><i
                                                                                        class="fa fa-angle-down"
                                                                                        aria-hidden="true"></i></span>
                                                                            </div>
                                                                        </div>
                                                                        <!-- .col-md-6 -->
                                                                        <div class="col-md-6">
                                                                            <div class="form-group">
                                                                                <label class="sr-only"
                                                                                    for="postcode">Postcode /
                                                                                    ZIP</label>
                                                                                <input type="text" class="form-control"
                                                                                    name="postCode" id="postcode"
                                                                                    placeholder="Postcode / ZIP">
                                                                            </div>
                                                                        </div>
                                                                        <!-- .col-md-6 -->
                                                                    </div>
                                                                    <!-- .row -->
                                                                    <button type="submit" class="btn btn-default">Update
                                                                        Total</button>
                                                                </form>
                                                            </div>
                                                            <!-- .col-md-6 -->
                                                            <div class="col-lg-6 col-12">
                                                                <h4>Cart Totals</h4>
                                                                <ul class="total-cart">
                                                                    <li>Cart Subtotal <span
                                                                            class="cart-subtotal"></span></li>
                                                                    <li class="shipping-handling">Shipping and Handling
                                                                        <span>Free Shipping</span>
                                                                    </li>
                                                                    <li>Order Total <span class="order-total"></span>
                                                                    </li>

                                                                </ul>
                                                            </div>
                                                            <!-- .col-md-6 -->
                                                        </div>
                                                        <!-- .row -->
                                                    </div>
                                                    <!-- .chipping-box -->



                                                </div>
                                                <!-- .product-cart-option -->
                                            </div>
                                            <!-- .row -->
                                        </div>
                                        <!-- .container -->
                                    </section>
                                    <!-- End Shop Cart Section -->


                                    <!-- Start Scrolling -->
                                    <div class="scroll-img"><i class="fa fa-angle-up" aria-hidden="true"></i></div>
                                    <!-- End Scrolling -->
                    </div>

                    <!-- Start Pre-Loader-->
                    <div id="loading">
                        <div id="loading-center">
                            <div id="loading-center-absolute">
                                <div class="object" id="object_one"></div>
                                <div class="object" id="object_two"></div>
                                <div class="object" id="object_three"></div>
                                <div class="object" id="object_four"></div>
                            </div>
                        </div>
                    </div>
                    <!-- End Pre-Loader -->



                    <script type="text/javascript" src="assets/js/jquery-2.2.3.min.js"></script>
                    <script type="text/javascript" src="assets/js/bootstrap.min.js"></script>
                    <script type="text/javascript" src="assets/js/jquery.easing.1.3.js"></script>
                    <script type="text/javascript" src="assets/js/jquery.waypoints.min.js"></script>
                    <script type="text/javascript" src="assets/js/jquery.counterup.min.js"></script>
                    <script type="text/javascript" src="assets/js/swiper.min.js"></script>
                    <script type="text/javascript" src="assets/js/plugins.isotope.js"></script>
                    <script type="text/javascript" src="assets/js/isotope.pkgd.min.js"></script>
                    <script type="text/javascript" src="assets/js/lightcase.js"></script>
                    <script type="text/javascript" src="assets/js/jquery.nstSlider.js"></script>
                    <script type="text/javascript" src="assets/js/jquery.flexslider.js"></script>
                    <script type="text/javascript" src="assets/js/custom.isotope.js"></script>
                    <script type="text/javascript" src="assets/js/custom.map.js"></script>

                    <script type="text/javascript" src="assets/js/custom.js"></script>
                    <script>
                        async function fetchCountries() {
                            try {
                                const response = await fetch('https://restcountries.com/v3.1/all');
                                const countries = await response.json();
                                countries.sort((a, b) => { return a.name.common < b.name.common ? -1 : 1 })

                                const countrySelect = document.getElementById('countries');

                                // Dynamically populate the select element
                                countries.forEach(country => {
                                    const option = document.createElement('option');
                                    option.value = country.name.common;
                                    option.textContent = country.name.common;
                                    countrySelect.appendChild(option);
                                    console.log(option.value + " " + option.textContent)
                                });
                                countrySelect.addEventListener('change', async function () {
                                    countryName = this.value
                                    console.log(countryName)
                                    const response = await fetch('https://countriesnow.space/api/v0.1/countries/states', {
                                        method: 'POST',
                                        headers: {
                                            'Content-Type': 'application/json',
                                        },
                                        body: JSON.stringify({
                                            country: countryName,
                                        }),
                                    });

                                    const data = await response.json();
                                    const stateSelect = document.getElementById('states');
                                    stateSelect.innerHTML = '';

                                    if (data && data.data && data.data.states) {
                                        console.log(`States in ${countryName}:`, data.data.states);
                                        data.data.states.forEach(state => {
                                            const option = document.createElement('option');
                                            option.value = state.name;
                                            option.textContent = state.name;
                                            stateSelect.appendChild(option);
                                            console.log(option.value + " " + option.textContent)
                                        });
                                    } else {
                                        console.log(`No states found for ${countryName}`);
                                        return [];
                                    }

                                })
                            } catch (error) {
                                console.error('Error fetching countries:', error);
                            }
                        }

                        fetchCountries()
                    </script>


</body>

</html>
